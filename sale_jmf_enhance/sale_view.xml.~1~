<?xml version="1.0" encoding="utf-8"?>

<openerp>
    <data>

         <record id="view_order_form_jmf_inh" model="ir.ui.view">
            <field name="name">sale.order.form</field>
            <field name="model">sale.order</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="jmf.view_order_form_jmf"/>
            <field name="arch" type="xml">
                <field name="estimated_delivery_date" position="after">
                    <field name="is_preorder"/>
                    <field name="if_sq_notify"/>
                    <field name="if_prepay_notify"/>
                    <field name="if_con_notify"/>
                </field>
                <button name="action_button_confirm" states="draft"  position="replace">
                    <field name="if_validated" invisible="1"/>
                    <button name="action_button_validate" attrs="{'invisible': [('state','not in',('draft','sent'))]}" string="Validate Sale" class="oe_highlight" type="object" groups="base.group_user"/>
                    <button name="action_button_confirm" states="draft" string="Confirm Sale" type="object" groups="sale.group_sale_confirm"/>
                </button>
                <button name="action_button_confirm" states="sent"  position="replace">
                    <button name="action_button_confirm" states="sent" string="Confirm Sale" class="oe_highlight" type="object" groups="sale.group_sale_confirm"/>
                </button>
                <!--button name="cancel" position="before">
                     attrs="{'invisible': [('if_validated','=', True)]}"
                </button-->
            </field>        
	    </record>

        <record id="view_order_tree_jmf_inh" model="ir.ui.view">
            <field name="name">sale.order.tree</field>
            <field name="model">sale.order</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="sale.view_quotation_tree"/>
            <field name="arch" type="xml">
                <field name="state" position="after">
                    <field name="is_preorder"/>
                 </field>
            </field>        
	 </record>

        <record id="action_quotations_validated" model="ir.actions.act_window">
            <field name="name">Validated Quotations</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="sale.view_quotation_tree"/>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="context">{}</field>
            <field name="domain">[('state','in',('draft','sent','cancel'))]</field>
            <field name="search_view_id" ref="sale.view_sales_order_filter"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a quotation, the first step of a new sale.
              </p><p>
                OpenERP will help you handle efficiently the complete sale flow:
                from the quotation to the sales order, the
                delivery, the invoicing and the payment collection.
              </p><p>
                The social feature helps you organize discussions on each sales
                order, and allow your customers to keep track of the evolution
                of the sales order.
              </p>
            </field>
        </record>

        <menuitem id="menu_sale_quotations_validated"
        action="action_quotations_validated" parent="base.menu_sales"
        sequence="4"/>

        <record id="sale.action_quotations" model="ir.actions.act_window">
            <field name="name">Quotations</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="sale.view_quotation_tree"/>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="context">{}</field>
            <field name="domain">[('state','in',('draft','sent','cancel'))]</field>
            <field name="search_view_id" ref="sale.view_sales_order_filter"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a quotation, the first step of a new sale.
              </p><p>
                OpenERP will help you handle efficiently the complete sale flow:
                from the quotation to the sales order, the
                delivery, the invoicing and the payment collection.
              </p><p>
                The social feature helps you organize discussions on each sales
                order, and allow your customers to keep track of the evolution
                of the sales order.
              </p>
            </field>
        </record>

    </data>
</openerp>
